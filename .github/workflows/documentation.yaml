name: build documentation

on:
  push:
    tags:
      - '*'

jobs:
  build_latex:
    runs-on: ubuntu-latest
    steps:
      - name: Loading the "base actions/checkout" so as to access latexindent.pl
        uses: actions/checkout@v2
      - name: Declare some variables
        id: vars
        shell: bash
        run: |
          echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
          echo "::set-output name=sha_short::$(git rev-parse --short HEAD)"
      - name: Another step
        run: |
          echo "Branch: ${{ steps.vars.outputs.branch }}"
          echo "Sha: ${{ steps.vars.outputs.sha_short }}"
      - name: sed stuff
        run: |
          cd documentation
          github_release=${{ steps.vars.outputs.branch }}
          github_sha_short=${{ steps.vars.outputs.sha_short }}
          github_branch="main"
          sed -i.bak  s/usepackage\\[mark,grumpy\\]{gitinfo2}/usepackage[mark]{gitinfo2}/ latexindent.tex
          sed -i.bak s/\\\\gitAbbrevHash/$github_sha_short/ latexindent.tex
          sed -i.bak s/\\\\gitBranch/$github_branch/ latexindent.tex
          sed -i.bak s/\\\\gitRel/$github_release/ latexindent.tex
          cat latexindent.tex

#jobs:
#  build_latex:
#    runs-on: ubuntu-latest
#    steps:
#      - name: Loading the "base actions/checkout" so as to access latexindent.pl
#        uses: actions/checkout@v2
#      - name: installing texlive full
#        uses: xu-cheng/texlive-action/full@v1
#        with:
#          run: |
#            apk add openjdk11
#            cd documentation
#            $(echo $GITHUB_REF)
#            branch_name=$(echo $GITHUB_REF | cut -d'/' -f 3)
#            github_sha_short=$(echo $GITHUB_SHA | cut -c1-7)
#            sed -i.bak  s/usepackage\\[mark,grumpy\\]{gitinfo2}/usepackage[mark]{gitinfo2}/ latexindent.tex
#            sed -i.bak s/\\\\gitAbbrevHash/$github_sha_short/ latexindent.tex
#            sed -i.bak s/\\\\gitBranch/$branch_name/ latexindent.tex
#            cat latexindent.tex
#            arara -v latexindent.tex
